<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>浪漫烟花祝福</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        love: {
                            primary: '#ff4d6d',
                            secondary: '#ff758f',
                            accent: '#ff8fa3',
                        },
                    },
                    fontFamily: {
                        romantic: ['Dancing Script', 'cursive'],
                    },
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow-glow {
                text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #ff4d6d, 0 0 40px #ff4d6d;
            }
            .animate-float {
                animation: float 3s ease-in-out infinite;
            }
            .firework-container {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                pointer-events: none;
                z-index: 10;
            }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
    </style>
    
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&display=swap" rel="stylesheet">
</head>
<body class="bg-black m-0 p-0 overflow-hidden">
    <!-- 音频元素 - 背景音乐 -->
    <audio id="bgMusic" loop>
        <source src="https://assets.mixkit.co/music/preview/mixkit-love-serenade-101.mp3" type="audio/mpeg">
    </audio>
    
    <!-- 点击区域 -->
    <div id="clickArea" class="absolute inset-0 flex items-center justify-center cursor-pointer z-20 transition-opacity duration-1000">
        <div class="text-4xl md:text-5xl font-romantic text-blue-400 hover:text-blue-300 transition-colors duration-300">
            <span class="inline-block animate-float">我喜欢你</span>
        </div>
    </div>
    
    <!-- 显示的文字 -->
    <div id="textDisplay" class="absolute inset-0 flex items-center justify-center opacity-0 pointer-events-none z-30 transition-opacity duration-2000">
        <div class="text-[clamp(2rem,5vw,4rem)] font-romantic font-bold text-love-primary text-shadow-glow">
            余生有你便足矣
        </div>
    </div>
    
    <!-- 烟花容器 -->
    <div id="fireworksContainer" class="firework-container"></div>
    
    <!-- 重播按钮 -->
    <button id="replayBtn" class="fixed bottom-5 right-5 bg-love-primary/70 hover:bg-love-primary text-white py-2 px-4 rounded-full shadow-lg transform scale-0 transition-all duration-500 z-40">
        <i class="fa fa-refresh mr-2"></i>再看一次
    </button>

    <script>
        // 全局变量
        let isFireworksActive = false;
        let canvas, ctx;
        let fireworks = [];
        let particles = [];
        let gravity;
        let hue = 120;
        
        // DOM元素
        const clickArea = document.getElementById('clickArea');
        const textDisplay = document.getElementById('textDisplay');
        const replayBtn = document.getElementById('replayBtn');
        const bgMusic = document.getElementById('bgMusic');
        
        // 初始化
        function init() {
            // 创建Canvas
            createCanvas();
            
            // 点击事件
            clickArea.addEventListener('click', startExperience);
            replayBtn.addEventListener('click', resetExperience);
            
            // 调整Canvas尺寸
            window.addEventListener('resize', resizeCanvas);
            
            // 设置重力
            gravity = 0.2;
        }
        
        // 创建Canvas
        function createCanvas() {
            canvas = document.createElement('canvas');
            canvas.id = 'fireworksCanvas';
            document.getElementById('fireworksContainer').appendChild(canvas);
            ctx = canvas.getContext('2d');
            resizeCanvas();
        }
        
        // 调整Canvas尺寸
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        
        // 开始体验
        function startExperience() {
            // 隐藏点击区域
            clickArea.style.opacity = '0';
            setTimeout(() => {
                clickArea.style.pointerEvents = 'none';
            }, 1000);
            
            // 显示文字
            setTimeout(() => {
                textDisplay.style.opacity = '1';
            }, 500);
            
            // 播放音乐
            playMusic();
            
            // 延迟后开始烟花
            setTimeout(() => {
                isFireworksActive = true;
                animate(); // 开始动画循环
                
                // 创建更多烟花
                for (let i = 0; i < 20; i++) {
                    setTimeout(() => {
                        launchFirework();
                    }, i * 1000);
                }
                
                // 显示重播按钮
                setTimeout(() => {
                    replayBtn.style.transform = 'scale(1)';
                }, 15000);
            }, 1500);
        }
        
        // 播放音乐
        function playMusic() {
            bgMusic.play().catch(e => {
                console.log('背景音乐播放失败:', e);
            });
        }
        
        // 重置体验
        function resetExperience() {
            // 清空所有烟花和粒子
            fireworks = [];
            particles = [];
            
            // 重置UI
            clickArea.style.opacity = '1';
            clickArea.style.pointerEvents = 'auto';
            textDisplay.style.opacity = '0';
            replayBtn.style.transform = 'scale(0)';
            
            // 停止音乐
            bgMusic.pause();
            bgMusic.currentTime = 0;
            
            // 重置状态
            isFireworksActive = false;
        }
        
        // 发射烟花
        function launchFirework() {
            const startX = Math.random() * canvas.width;
            const startY = canvas.height;
            const targetX = Math.random() * canvas.width;
            const targetY = Math.random() * canvas.height * 0.5; // 上半部分
            
            // 随机颜色
            hue = Math.random() * 360;
            
            // 创建烟花
            const firework = {
                x: startX,
                y: startY,
                targetX,
                targetY,
                speed: 6 + Math.random() * 2,
                radius: 3 + Math.random() * 2,
                hue: hue,
                brightness: 50 + Math.random() * 30,
                trail: [],
                trailLength: 10,
                alpha: 1
            };
            
            fireworks.push(firework);
        }
        
        // 动画循环
        function animate() {
            if (!isFireworksActive) return;
            
            // 清除画布
            ctx.globalCompositeOperation = 'destination-out';
            ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.globalCompositeOperation = 'lighter';
            
            // 更新色调
            hue += 0.5;
            
            // 绘制所有粒子
            for (let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                
                // 更新位置
                p.x += p.vx;
                p.y += p.vy;
                
                // 应用重力和阻力
                p.vy += gravity;
                p.vx *= 0.99;
                p.vy *= 0.99;
                
                // 更新生命周期
                p.life -= 0.01;
                
                // 如果粒子生命周期结束，移除
                if (p.life <= 0) {
                    particles.splice(i, 1);
                    continue;
                }
                
                // 绘制粒子
                ctx.beginPath();
                ctx.fillStyle = `hsla(${p.hue}, 100%, ${p.brightness}%, ${p.life})`;
                ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                ctx.fill();
                
                // 绘制尾迹
                ctx.beginPath();
                ctx.moveTo(p.x, p.y);
                ctx.lineTo(p.x - p.vx * 3, p.y - p.vy * 3);
                ctx.strokeStyle = `hsla(${p.hue}, 100%, ${p.brightness}%, ${p.life * 0.5})`;
                ctx.lineWidth = p.size;
                ctx.stroke();
            }
            
            // 更新并绘制所有烟花
            for (let i = fireworks.length - 1; i >= 0; i--) {
                const firework = fireworks[i];
                
                // 保存轨迹
                firework.trail.push({ x: firework.x, y: firework.y });
                if (firework.trail.length > firework.trailLength) {
                    firework.trail.shift();
                }
                
                // 计算到目标的距离
                const dx = firework.targetX - firework.x;
                const dy = firework.targetY - firework.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                // 如果到达目标，爆炸
                if (distance < 2) {
                    explodeFirework(firework.x, firework.y, firework.hue);
                    fireworks.splice(i, 1);
                    continue;
                }
                
                // 移动烟花
                const angle = Math.atan2(dy, dx);
                firework.x += Math.cos(angle) * firework.speed;
                firework.y += Math.sin(angle) * firework.speed;
                
                // 绘制轨迹
                for (let j = 0; j < firework.trail.length; j++) {
                    const trailPoint = firework.trail[j];
                    const size = firework.radius * (1 - j / firework.trail.length);
                    const alpha = firework.alpha * (1 - j / firework.trail.length);
                    
                    ctx.beginPath();
                    ctx.fillStyle = `hsla(${firework.hue}, 100%, ${firework.brightness}%, ${alpha})`;
                    ctx.arc(trailPoint.x, trailPoint.y, size, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                // 绘制烟花
                ctx.beginPath();
                ctx.fillStyle = `hsla(${firework.hue}, 100%, ${firework.brightness}%, ${firework.alpha})`;
                ctx.arc(firework.x, firework.y, firework.radius, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // 随机发射新烟花
            if (Math.random() < 0.02) {
                launchFirework();
            }
            
            requestAnimationFrame(animate);
        }
        
        // 烟花爆炸
        function explodeFirework(x, y, hue) {
            // 创建大量粒子
            const particleCount = 200 + Math.floor(Math.random() * 100); // 200-300个粒子
            
            for (let i = 0; i < particleCount; i++) {
                const angle = Math.random() * Math.PI * 2;
                const speed = 3 + Math.random() * 5;
                
                // 粒子速度分解为x和y分量
                const vx = Math.cos(angle) * speed;
                const vy = Math.sin(angle) * speed;
                
                // 随机大小
                const size = 1 + Math.random() * 3;
                
                // 随机生命周期
                const life = 0.5 + Math.random() * 0.5;
                
                // 随机亮度
                const brightness = 50 + Math.random() * 50;
                
                // 随机色调（在主色调附近）
                const particleHue = hue + (Math.random() * 60 - 30);
                
                particles.push({
                    x,
                    y,
                    size,
                    hue: particleHue,
                    brightness,
                    life,
                    vx,
                    vy
                });
            }
            
            // 添加爆炸闪光效果
            ctx.beginPath();
            ctx.arc(x, y, 15, 0, Math.PI * 2);
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            ctx.fill();
        }
        
        // 初始化
        init();
    </script>
</body>
</html>
